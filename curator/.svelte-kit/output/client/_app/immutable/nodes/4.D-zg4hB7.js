import{c as M,a as g,f as x,t as Oe}from"../chunks/D6MYdS9h.js";import{p as me,f as c,a as be,c as ee,r as te,t as De,y as ke,e as l,b,g as e,h as G,s,n as Pe,z as H}from"../chunks/CqKpht16.js";import{a as ue}from"../chunks/HfSINFkk.js";import{p as Ie,i as k,c as v}from"../chunks/cli-iPJS.js";import{b as $e,D as ye,c as Le,E as Se,d as Ee}from"../chunks/D-VGJNw3.js";import"../chunks/CB1YDqdC.js";import{c as he,f as Me,h as Re,i as ze,j as Ue,N as We}from"../chunks/ZeYipwfv.js";import{T as je,c as Ae,d as Ce,e as qe,f as Be,g as Fe,l as pe,m as _e,h as Ge,i as fe,b as He}from"../chunks/IOBaASFu.js";import{T as Je}from"../chunks/CGZBc23e.js";var Ke=x("<div><!></div>");function Qe(J,R){me(R,!0);let a=Ie(R,"class",3,"");const i=he();var z=M(),P=c(z);{var u=d=>{var _=Ke(),I=ee(_);Me(I,()=>R.children),te(_),De($=>Ue(_,1,$),[()=>Re(ze("bottom-15 fixed right-8 z-30",a()))]),g(d,_)};k(P,d=>{i.isMobile&&d(u)})}g(J,z),be()}var Ve=x("<!> <!>",1),Xe=x('<!> <!> <div class="hidden grow md:block"></div> <!> <!> <!> <!> <div class="divider divider-horizontal hidden md:flex"></div> <!> <!> <!> <!>',1),Ye=x('<div class="flex flex-row gap-x-2"><!> <!></div> <!>',1),Ze=x('<!> <div class="h-[calc(100vh-60px)]"><!></div> <!>',1),et=x('<div class="grid h-screen place-items-center"><br/></div>'),tt=x("<!> <!> <!> <!>",1),at=x("<!> <!>",1);function ct(J,R){me(R,!0);const a=new We("discovery");let i=G(()=>a.note);const z=he();let P=b(0),u=b(1),d=b(0),_=b(99),I=b(!1),$=b(!1),C=b(!1),q=b(!1);async function N(){e(d)==e(_)&&e(u)==e(P)||(H(d),e(d)==100&&(H(u),await a.getDiscoverNoteList(e(u)),l(d,0)),await a.getDiscoverNote(e(d)),l(_,a.noteList.items.length-1))}async function ae(){e(d)==0&&e(u)==1||(H(d,-1),e(d)<0&&e(u)>1&&(H(u,-1),await a.getDiscoverNoteList(e(u)),l(d,99)),await a.getDiscoverNote(e(d)))}async function re(){await a.upvoteWeight(),await N()}async function ne(){await a.downvoteWeight(),await N()}let K=b(void 0);ke(async()=>{await a.getDiscoverNoteList(1),l(K,await a.getDiscoverNote(0),!0),l(P,a.noteList.totalPages,!0)});var oe=at(),se=c(oe);ue(se,()=>e(K),null,Q=>{var U=M(),V=c(U);{var X=f=>{var w=Ze(),j=c(w);v(j,()=>He,(r,L)=>{L(r,{children:(S,E)=>{var A=Xe(),B=c(A);v(B,()=>je,(n,t)=>{t(n,{})});var F=s(B,2);{var T=n=>{var t=Ve(),o=c(t);v(o,()=>pe,(m,D)=>{D(m,{get currentIndex(){return e(d)},get currentPage(){return e(u)},get totalPages(){return e(P)},get lastItemIndex(){return e(_)},onLeft:ae,onRight:N})});var O=s(o,2);v(O,()=>_e,(m,D)=>{D(m,{onUp:re,onDown:ne})}),g(n,t)};k(F,n=>{z.isMobile||n(T)})}var h=s(F,4);{var Z=n=>{var t=M(),o=c(t);v(o,()=>Je,(O,m)=>{m(O,{get tags(){return e(i).expand.tags}})}),g(n,t)};k(h,n=>{var t,o;(o=(t=e(i))==null?void 0:t.expand)!=null&&o.tags&&n(Z)})}var ie=s(h,2);v(ie,()=>Ae,(n,t)=>{t(n,{get isOpen(){return e($)},set isOpen(o){l($,o,!0)}})});var de=s(ie,2);{var Ne=n=>{var t=M(),o=c(t);v(o,()=>Ge,(O,m)=>{m(O,{get notebook(){return e(i).expand.notebook},get isOpen(){return e(C)},set isOpen(D){l(C,D,!0)}})}),g(n,t)};k(de,n=>{var t,o;(o=(t=e(i))==null?void 0:t.expand)!=null&&o.notebook&&n(Ne)})}var ve=s(de,2);{var we=n=>{var t=M(),o=c(t);v(o,()=>fe,(O,m)=>{m(O,{get rating(){return e(i).rating},action:D=>{a.changeRating(D)}})}),g(n,t)};k(ve,n=>{z.isMobile||n(we)})}var ge=s(ve,4);v(ge,()=>Ce,(n,t)=>{t(n,{get isOpen(){return e(q)},set isOpen(o){l(q,o,!0)}})});var le=s(ge,2);v(le,()=>qe,(n,t)=>{t(n,{get noteStatus(){return e(i).status},archive:()=>{a.archiveNote(),N()},unarchive:()=>{a.unArchiveNote(),N()}})});var ce=s(le,2);v(ce,()=>Be,(n,t)=>{t(n,{get noteStatus(){return e(i).status},get isOpen(){return e(I)},set isOpen(o){l(I,o,!0)}})});var Te=s(ce,2);v(Te,()=>Fe,(n,t)=>{t(n,{get note(){return e(i)}})}),g(S,A)},$$slots:{default:!0}})});var y=s(j,2),Y=ee(y);$e(Y,{get noteState(){return a}}),te(y);var p=s(y,2);Qe(p,{class:"p-golden-md bg-base-100 flex flex-col items-end gap-y-2 rounded-md",children:(r,L)=>{var S=Ye(),E=c(S),A=ee(E);v(A,()=>_e,(T,h)=>{h(T,{onUp:re,onDown:ne})});var B=s(A,2);v(B,()=>pe,(T,h)=>{h(T,{get currentIndex(){return e(d)},get currentPage(){return e(u)},get totalPages(){return e(P)},get lastItemIndex(){return e(_)},onLeft:ae,onRight:N})}),te(E);var F=s(E,2);v(F,()=>fe,(T,h)=>{h(T,{get rating(){return e(i).rating},action:Z=>{a.changeRating(Z)}})}),g(r,S)},$$slots:{default:!0}}),g(f,w)},W=f=>{var w=et();g(f,w)};k(V,f=>{e(i)?f(X):f(W,!1)})}g(Q,U)});var xe=s(se,2);ue(xe,()=>e(K),null,Q=>{var U=M(),V=c(U);{var X=W=>{var f=tt(),w=c(f);ye(w,{name:"Note",action:()=>{a.softDeleteNote(),N()},get isOpen(){return e(I)},set isOpen(p){l(I,p,!0)},children:(p,r)=>{Pe();var L=Oe("this note");g(p,L)},$$slots:{default:!0}});var j=s(w,2);{let p=G(()=>{var r;return(r=e(i).expand)==null?void 0:r.notebook.id});Le(j,{get currentNotebookID(){return e(p)},action:r=>{a.changeNotebook(r)},get isOpen(){return e(C)},set isOpen(r){l(C,r,!0)}})}var y=s(j,2);{let p=G(()=>{var r;return(r=e(i).expand)==null?void 0:r.tags});Se(y,{get currentTags(){return e(p)},add:r=>a.addTag(r),remove:r=>a.removeTag(r),get isOpen(){return e($)},set isOpen(r){l($,r,!0)}})}var Y=s(y,2);{let p=G(()=>{var r;return(r=e(i))==null?void 0:r.thumbnail});Ee(Y,{get note(){return e(i)},get thumbURL(){return e(p)},action:async(r,L,S,E)=>{await a.changeTitle(r),await a.changeDescription(L),await a.changeSources(S),await a.changeThumbnail(E),await a.getNote()},get isOpen(){return e(q)},set isOpen(r){l(q,r,!0)}})}g(W,f)};k(V,W=>{e(i)&&W(X)})}g(Q,U)}),g(J,oe),be()}export{ct as component};
